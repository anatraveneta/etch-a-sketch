Inhibit drag behaviour of grid element. Simplify paintElement and computeColor code. Add comments.